<div class="bg-primary-100">
  <div class="card p-5">
    <h1 class="text-center">Form</h1>
    <form [formGroup]="taskForm" *ngIf="taskForm" (ngSubmit)="onSubmit()">
      <div class="flex flex-wrap card-container" style="max-width: 100%">
        <div
          *ngFor="let item of jsonData; let i = index"
          class="flex align-items-center justify-content-center font-bold m-2"
          style="min-width: 30%; min-height: 100px"
        >
          <div class="field col">
            <ng-container
              *ngIf="
                item.type === 'text' ||
                item.type === 'email' ||
                item.type === 'number' ||
                item.type === 'date'
              "
            >
              <label [for]="item.controlName">{{ item.label }}</label> <br />
              <span class="flex">
                <div *ngIf="item.controlName === 'phonenumber'" class="mr-2">
                  <p-dropdown
                    [formControlName]="item.countryCodes[0].controlName"
                    [options]="item.countryCodes[0].countryCodesDropDown"
                    [style]="{ width: '120px', height: '40px', padding: '1' }"
                    placeholder="Country code"
                  ></p-dropdown>
                </div>
                <input
                  [type]="item.type"
                  [formControlName]="item.controlName"
                  class="text-base text-color surface-overlay p-2 border-1 border-solid surface-border border-round appearance-none outline-none focus:border-primary w-full"
                />
              </span>
              <div *ngIf="item.controlName === 'phonenumber'">
                <div
                  *ngIf="
                    taskForm.get(item.countryCodes[0].controlName)?.invalid &&
                    (taskForm.get(item.countryCodes[0].controlName)?.dirty ||
                      taskForm.get(item.countryCodes[0].controlName)?.touched)
                  "
                >
                  <div
                    class="text-red-600"
                    *ngIf="taskForm.get(item.countryCodes[0].controlName)?.errors?.['required']"
                  >
                    {{ item.countryCodes[0].requiredMessage }}
                  </div>
                </div>
              </div>
              <div
                *ngIf="
                  taskForm.get(item.controlName)?.invalid &&
                  (taskForm.get(item.controlName)?.dirty ||
                    taskForm.get(item.controlName)?.touched)
                "
              >
                <div
                  class="text-red-600"
                  *ngIf="taskForm.get(item.controlName)?.errors?.['required']"
                >
                  {{ item.requiredMessage }}
                </div>
                <div
                  class="text-red-600"
                  *ngIf="taskForm.get(item.controlName)?.errors?.['pattern']"
                >
                  {{ item.patternMessage }}
                </div>
                <div
                  class="text-red-600"
                  *ngIf="taskForm.get(item.controlName)?.errors?.['email']"
                >
                  {{ item.emailformatMessage }}
                </div>
                <div
                  class="text-red-600"
                  *ngIf="taskForm.get(item.controlName)?.errors?.['minlength'] "
                >
                  {{ item.minLengthMessage }}
                </div>
                <div
                  class="text-red-600"
                  *ngIf="taskForm.get(item.controlName)?.errors?.['maxlength'] "
                >
                  {{ item.maxLengthMessage }}
                </div>
              </div>
            </ng-container>
            <!-- dropdown data -->
            <div
              class="flex flex-wrap card-container m-2"
              style="max-width: 100%"
            >
              <ng-container *ngIf="item.type === 'select'">
                <div class="field col">
                  <ng-container *ngIf="item.type === 'select'">
                    <label for="item.label">{{ item.label }}</label
                    ><br />
                    <p-dropdown
                      [formControlName]="item.controlName"
                      (onChange)="formSubmit($event, item.controlName)"
                      [style]="{ width: '300px', height: '40px', padding: '1' }"
                      [options]="item.countryDropOptions"
                      optionLabel="value"
                      placeholder="Select Countries"
                    ></p-dropdown>
                    <div
                      *ngIf="
                        taskForm.get(item.controlName)?.invalid &&
                        (taskForm.get(item.controlName)?.dirty ||
                          taskForm.get(item.controlName)?.touched)
                      "
                    >
                      <div
                        class="text-red-600"
                        *ngIf="taskForm.get(item.controlName)?.errors?.['required']"
                      >
                        {{ item.requiredMessage }}
                      </div>
                    </div>
                  </ng-container>
                </div>
                <div class="field col">
                  <ng-container *ngIf="stateData">
                    <div *ngFor="let state of stateData">
                      <label for="item.label">{{ state.label }}</label
                      ><br />
                      <p-dropdown
                        [formControlName]="state.controlName"
                        (onChange)="forDistrict($event, state.controlName)"
                        [style]="{
                          width: '350px',
                          height: '40px',
                          padding: '1'
                        }"
                        [options]="countryStates"
                        optionLabel="value"
                        placeholder="Select States"
                      ></p-dropdown>
                      <div
                        *ngIf="
                          taskForm.get(state.controlName)?.invalid &&
                          taskForm.get(state.controlName)?.touched
                        "
                      >
                        <div class="text-red-600">
                          {{ state.requiredMessage }}
                        </div>
                      </div>
                    </div>
                  </ng-container>
                </div>
                <div class="field col">
                  <ng-container *ngIf="districtData">
                    <div *ngFor="let district of districtData; let i = index">
                      <label for="item.label">{{ district.label }}</label
                      ><br />
                      <p-dropdown
                        [formControlName]="district.controlName"
                        (onChange)="
                          onDistrictChange($event, district.controlName)
                        "
                        [style]="{
                          width: '350px',
                          height: '40px',
                          padding: '1'
                        }"
                        [options]="stateDistricts"
                        optionLabel="value"
                        placeholder="Select Districts"
                      ></p-dropdown>
                      <div
                        *ngIf="
                          taskForm.get(district.controlName)?.invalid &&
                          (taskForm.get(district.controlName)?.dirty ||
                            taskForm.get(district.controlName)?.touched)
                        "
                      >
                        <div
                          class="text-red-600"
                          *ngIf="taskForm.get(district.controlName)?.errors?.['required']"
                        >
                          {{ district.requiredMessage }}
                        </div>
                      </div>
                    </div>
                  </ng-container>
                </div>
              </ng-container>
            </div>
            <!-- radio -->
            <ng-container *ngIf="item.type === 'radio'">
              <div class="">
                <label for="item.controlName">{{ item.label }}</label
                ><br />
                <div class="flex flex-wrap gap-3 mt-3">
                  <div
                    *ngFor="let category of item.genderCategories"
                    class="field-checkbox"
                  >
                    <p-radioButton
                      [inputId]="category.key"
                      (click)="onGenderChange(item.controlName)"
                      [value]="category"
                      [formControlName]="item.controlName"
                    ></p-radioButton>
                    <label [for]="category.key" class="ml-2">{{
                      category.name
                    }}</label>
                    <div
                      *ngIf="
                        taskForm.get(item.controlName)?.invalid &&
                        (taskForm.get(item.controlName)?.dirty ||
                          taskForm.get(item.controlName)?.touched)
                      "
                    >
                      <div
                        class="text-red-600"
                        *ngIf="taskForm.get(item.controlName)?.errors?.['required']"
                      >
                        {{ item.requiredMessage }}
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </ng-container>
            <ng-container *ngIf="item.type === 'multiselect'">
              <label for="item.controlName">{{ item.label }}</label
              ><br />
              <div class="flex flex-wrap gap-3">
                <div class="card flex justify-content-center">
                  <div
                    *ngFor="let category of item.Checkboxes; let i = index"
                    class="field-checkbox"
                  ></div>
                  <p-multiSelect
                    [options]="item.Checkboxes"
                    [formControlName]="item.controlName"
                    [style]="{ width: '320px', height: '40px' }"
                    placeholder="{{ item.placeholder }}"
                  ></p-multiSelect>
                </div>
              </div>
              <div
                *ngIf="
                  taskForm.get(item.controlName)?.invalid &&
                  taskForm.get(item.controlName)?.touched
                "
              >
                <div
                  class="text-red-600"
                  *ngIf="taskForm.get(item.controlName)?.errors?.['required']"
                >
                  {{ item.requiredMessage }}
                </div>
              </div>
            </ng-container>
          </div>
        </div>
      </div>
      <div class="card flex justify-content-center">
        <p-button
          label="Submit"
          [disabled]="taskForm.invalid"
          type="submit"
          class="mr-2"
          icon="pi pi-check"
        ></p-button>
        <p-button
          label="Reset"
          type="reset"
          styleClass="p-button-danger"
          icon="pi pi-check"
        ></p-button>
      </div>
    </form>
  </div>
</div>
